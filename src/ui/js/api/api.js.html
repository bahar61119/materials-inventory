<script>
    class API {
        static call(options) {
            Spinner.show();
            google.script.run
                .withSuccessHandler(data => {
                    Spinner.hide();
                    Tooltip.enable();
                    options.success(data);
                })
                .withFailureHandler(error => {
                    Spinner.hide();
                    options.failure(error);
                })
                [options.api](options.data);
        }

        static get NAME() {
            return {
                loadNavbarView: "loadNavbarView",
                loadHomeView: "loadHomeView",
                loadSupplierListView: "loadSupplierListView",
                loadAddSupplierView: "loadAddSupplierView",
                loadEditSupplierView: "loadEditSupplierView",
                getSupplierList: "getSupplierList",
                deleteSupplier:"deleteSupplier",
                updateSupplier:"updateSupplier",
                loadProfileUpdateView: "loadProfileUpdateView",
                updateProfile: "updateProfile",
                deleteProfile: "deleteProfile",
                loadSettingsView: "loadSettingsView",
                addAuthorizeUser: "addAuthorizeUser",
                deleteAuthorizeUser: "deleteAuthorizeUser",
                loadSettingsAuthorizationView: "loadSettingsAuthorizationView",
                loadItemListView: "loadItemListView",
                getItemList: "getItemList",
                loadEditItemView: "loadEditItemView",
                loadAddItemView: "loadAddItemView",
                updateItem: "updateItem",
                deleteItem: "deleteItem",
                loadInvoiceListView: "loadInvoiceListView",
                getInvoiceList: "getInvoiceList",
                loadAddInvoiceView: "loadAddInvoiceView",
                loadEditInvoiceView: "loadEditInvoiceView",
                updateInvoice: "updateInvoice",
                deleteInvoice: "deleteInvoice",
                loadEntryListView: "loadEntryListView",
                getEntryList: "getEntryList",
                loadAddEntryView: "loadAddEntryView",
                loadEditEntryView: "loadEditEntryView",
                updateEntry: "updateEntry",
                deleteEntry: "deleteEntry",
                loadPaymentListView: "loadPaymentListView",
                getPaymentList: "getPaymentList",
                loadAddPaymentView: "loadAddPaymentView",
                loadEditPaymentView: "loadEditPaymentView",
                updatePayment: "updatePayment",
                deletePayment: "deletePayment"
            }
        }

        static loadNavbarView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadNavbarView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadHomeView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadHomeView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadSupplierListView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadSupplierListView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadAddSupplierView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadAddSupplierView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadEditSupplierView(supplierId, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadEditSupplierView)
                .withData(supplierId)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static getSupplierList(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.getSupplierList)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static deleteSupplier(supplierId, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.deleteSupplier)
                .withData(supplierId)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static updateSupplier(supplier, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.updateSupplier)
                .withData(supplier)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadProfileUpdateView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadProfileUpdateView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static updateProfile(user, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.updateProfile)
                .withData(user)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static deleteProfile(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.deleteProfile)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadSettingsView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadSettingsView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static addAuthorizeUser(authorizeUserEmail, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.addAuthorizeUser)
                .withData(authorizeUserEmail)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static deleteAuthorizeUser(authorizeUserEmail, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.deleteAuthorizeUser)
                .withData(authorizeUserEmail)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadSettingsAuthorizationView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadSettingsAuthorizationView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadItemListView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadItemListView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static getItemList(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.getItemList)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadEditItemView(itemId, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadEditItemView)
                .withData(itemId)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadAddItemView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadAddItemView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static deleteItem(itemId, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.deleteItem)
                .withData(itemId)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static updateItem(item, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.updateItem)
                .withData(item)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadInvoiceListView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadInvoiceListView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static getInvoiceList(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.getInvoiceList)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadEditInvoiceView(invoiceId, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadEditInvoiceView)
                .withData(invoiceId)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadAddInvoiceView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadAddInvoiceView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static deleteInvoice(invoiceId, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.deleteInvoice)
                .withData(invoiceId)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static updateInvoice(invoice, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.updateInvoice)
                .withData(invoice)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadEntryListView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadEntryListView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static getEntryList(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.getEntryList)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadEditEntryView(entryId, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadEditEntryView)
                .withData(entryId)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadAddEntryView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadAddEntryView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static deleteEntry(entryId, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.deleteEntry)
                .withData(entryId)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static updateEntry(entry, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.updateEntry)
                .withData(entry)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadPaymentListView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadPaymentListView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static getPaymentList(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.getPaymentList)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadEditPaymentView(paymentId, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadEditPaymentView)
                .withData(paymentId)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadAddPaymentView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadAddPaymentView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static deletePayment(paymentId, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.deletePayment)
                .withData(paymentId)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static updatePayment(payment, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.updatePayment)
                .withData(payment)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }
    }
</script>