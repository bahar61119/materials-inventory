<script>
    class API {
        static call(options) {
            Spinner.show();
            google.script.run
                .withSuccessHandler(data => {
                    Spinner.hide();
                    Tooltip.enable();
                    options.success(data);
                })
                .withFailureHandler(error => {
                    Spinner.hide();
                    options.failure(error);
                })
                [options.api](options.data);
        }

        static get NAME() {
            return {
                loadNavbarView: "loadNavbarView",
                loadHomeView: "loadHomeView",
                loadSupplierListView: "loadSupplierListView",
                loadAddSupplierView: "loadAddSupplierView",
                loadEditSupplierView: "loadEditSupplierView",
                getSupplierList: "getSupplierList",
                deleteSupplier:"deleteSupplier",
                updateSupplier:"updateSupplier",
                loadProfileUpdateView: "loadProfileUpdateView",
                updateProfile: "updateProfile",
                deleteProfile: "deleteProfile",
                loadSettingsView: "loadSettingsView",
                addAuthorizeUser: "addAuthorizeUser",
                deleteAuthorizeUser: "deleteAuthorizeUser",
                loadSettingsAuthorizationView: "loadSettingsAuthorizationView",
                loadItemListView: "loadItemListView",
                getItemList: "getItemList"
            }
        }

        static loadNavbarView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadNavbarView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadHomeView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadHomeView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadSupplierListView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadSupplierListView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadAddSupplierView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadAddSupplierView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadEditSupplierView(supplierId, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadEditSupplierView)
                .withData(supplierId)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static getSupplierList(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.getSupplierList)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static deleteSupplier(supplierId, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.deleteSupplier)
                .withData(supplierId)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static updateSupplier(supplier, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.updateSupplier)
                .withData(supplier)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadProfileUpdateView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadProfileUpdateView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static updateProfile(user, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.updateProfile)
                .withData(user)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static deleteProfile(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.deleteProfile)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadSettingsView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadSettingsView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static addAuthorizeUser(authorizeUserEmail, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.addAuthorizeUser)
                .withData(authorizeUserEmail)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static deleteAuthorizeUser(authorizeUserEmail, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.deleteAuthorizeUser)
                .withData(authorizeUserEmail)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadSettingsAuthorizationView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadSettingsAuthorizationView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadItemListView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadItemListView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static getItemList(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.getItemList)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }
    }
</script>