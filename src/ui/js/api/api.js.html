<script>
    class API {
        static call(options) {
            Spinner.show();
            google.script.run
                .withSuccessHandler(data => {
                    Spinner.hide();
                    options.success(data);
                })
                .withFailureHandler(error => {
                    Spinner.hide();
                    options.failure(error);
                })
                [options.api](options.data);
        }

        static get NAME() {
            return {
                loadHomeView: "loadHomeView",
                loadSupplierListView: "loadSupplierListView",
                loadAddSupplierView: "loadAddSupplierView",
                loadEditSupplierView: "loadEditSupplierView",
                getSupplierList: "getSupplierList",
                deleteSupplier:"deleteSupplier",
                updateSupplier:"updateSupplier",
                updateProfile: "updateProfile"
            }
        }

        static loadHomeView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadHomeView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadSupplierListView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadSupplierListView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadAddSupplierView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadAddSupplierView)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static loadEditSupplierView(supplierId, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadEditSupplierView)
                .withData(supplierId)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static getSupplierList(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.getSupplierList)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static deleteSupplier(supplierId, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.deleteSupplier)
                .withData(supplierId)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static updateSupplier(supplier, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.updateSupplier)
                .withData(supplier)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }

        static updateProfile(user, successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.updateProfile)
                .withData(user)
                .withSuccess(successHandler)
                .withFailure(failureHandler)
            );
        }
    }
</script>