<script>
    class API {
        static call(options) {
            Spinner.show();
            google.script.run
                .withSuccessHandler(data => {
                    Spinner.hide();
                    options.success(data);
                })
                .withFailureHandler(error => {
                    Spinner.hide();
                    options.failure(error);
                })
                [options.api]();
        }

        static get NAME() {
            return {
                loadSupplierListView: "loadSupplierListView",
                loadAddSupplierView: "loadAddSupplierView",
                loadEditSupplierView: "loadEditSupplierView",
                getSupplierList: "getSupplierList"
            }
        }

        static loadSupplierListView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadSupplierListView)
                .setSuccess(successHandler)
                .setFailure(failureHandler)
            );
        }

        static loadAddSupplierView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadAddSupplierView)
                .setSuccess(successHandler)
                .setFailure(failureHandler)
            );
        }

        static loadEditSupplierView(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.loadEditSupplierView)
                .setSuccess(successHandler)
                .setFailure(failureHandler)
            );
        }

        static getSupplierList(successHandler = ()=>{}, failureHandler = ()=>{}) {
            API.call(
                APIOptions.of(API.NAME.getSupplierList)
                .setSuccess(successHandler)
                .setFailure(failureHandler)
            );
        }
    }
</script>